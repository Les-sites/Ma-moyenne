<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Calculateur de Moyenne</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f1f5f9; }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
        input[type="number"]::-webkit-inner-spin-button, input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        .ai-glow { animation: glow 2s infinite alternate; }
        @keyframes glow { from { box-shadow: 0 0 5px rgba(79, 70, 229, 0.2); } to { box-shadow: 0 0 15px rgba(79, 70, 229, 0.5); } }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen">

    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
            <div>
                <h1 class="text-3xl font-extrabold text-slate-900 tracking-tight">Mes Notes</h1>
                <p class="text-slate-500">Sauvegarde locale automatique ‚úÖ</p>
            </div>
            <div class="px-6 py-3 rounded-2xl bg-white shadow-sm border border-slate-200 text-center min-w-[180px]">
                <span class="text-xs font-bold text-slate-400 uppercase tracking-widest">Moyenne G√©n√©rale</span>
                <div id="moyenne-generale" class="text-3xl font-black text-indigo-600">-- / 20</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Formulaire et Liste -->
            <div class="space-y-6">
                <div class="glass-card p-6 rounded-3xl shadow-xl border border-white">
                    <h2 class="text-lg font-bold text-slate-800 mb-4">Ajouter une note</h2>
                    <div class="space-y-4">
                        <input type="text" id="nom-matiere" placeholder="Mati√®re (ex: Maths)" class="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 outline-none focus:ring-2 focus:ring-indigo-500">
                        <div class="grid grid-cols-2 gap-3">
                            <input type="number" id="moy-matiere" placeholder="Note /20" step="0.1" class="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 outline-none focus:ring-2 focus:ring-indigo-500">
                            <input type="number" id="coeff-matiere" placeholder="Coeff" value="1" class="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <button id="btn-add" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-xl transition-all shadow-lg shadow-indigo-200">
                            Ajouter √† la liste
                        </button>
                    </div>
                </div>
                
                <div id="liste-matieres" class="space-y-3 max-h-[500px] overflow-y-auto pr-2">
                    <!-- Les mati√®res s'afficheront ici -->
                </div>
            </div>

            <!-- Graphique et IA -->
            <div class="lg:col-span-2 space-y-6">
                <div class="glass-card p-6 rounded-3xl shadow-xl h-[350px]">
                    <canvas id="performanceChart"></canvas>
                </div>

                <div class="glass-card p-6 rounded-3xl shadow-xl border-t-4 border-t-indigo-500 ai-glow">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-lg font-bold text-slate-800 flex items-center gap-2">ü§ñ Assistant IA</h2>
                        <button id="btn-ia" class="text-xs bg-slate-900 text-white px-5 py-2.5 rounded-full hover:bg-indigo-600 transition-all">
                            Analyser mes r√©sultats
                        </button>
                    </div>
                    <div id="ai-response" class="text-slate-700 text-sm leading-relaxed p-4 bg-white rounded-2xl border border-slate-100 italic">
                        Ajoutez des notes pour recevoir des conseils personnalis√©s...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Configuration ---
        const geminiKey = ""; // Optionnel : ajoute ta cl√© Gemini ici
        let matieres = JSON.parse(localStorage.getItem('mes-notes')) || [];
        let chart = null;

        // --- Initialisation Graphique ---
        function initChart() {
            const ctx = document.getElementById('performanceChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Notes',
                        data: [],
                        backgroundColor: 'rgba(79, 70, 229, 0.4)',
                        borderColor: '#4f46e5',
                        borderWidth: 2,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, max: 20 } }
                }
            });
            render();
        }

        // --- Fonctions de Gestion ---
        function save() {
            localStorage.setItem('mes-notes', JSON.stringify(matieres));
            render();
        }

        function render() {
            const listEl = document.getElementById('liste-matieres');
            listEl.innerHTML = '';
            let totalPoints = 0;
            let totalCoeffs = 0;

            matieres.forEach((m, index) => {
                totalPoints += (m.note * m.coeff);
                totalCoeffs += m.coeff;

                const card = document.createElement('div');
                card.className = "bg-white p-4 rounded-2xl shadow-sm border border-slate-200 flex justify-between items-center animate-in fade-in slide-in-from-bottom-2";
                card.innerHTML = `
                    <div>
                        <div class="font-bold text-slate-800">${m.nom}</div>
                        <div class="text-xs text-slate-400 font-bold uppercase">Coeff ${m.coeff}</div>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="text-lg font-black text-indigo-600">${m.note}/20</div>
                        <button onclick="supprimer(${index})" class="text-slate-300 hover:text-red-500 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" stroke-width="2" stroke-linecap="round"/></svg>
                        </button>
                    </div>
                `;
                listEl.appendChild(card);
            });

            // Calcul Moyenne
            const moyenne = totalCoeffs > 0 ? (totalPoints / totalCoeffs).toFixed(2) : "--";
            document.getElementById('moyenne-generale').textContent = `${moyenne} / 20`;

            // Update Chart
            if (chart) {
                chart.data.labels = matieres.map(m => m.nom);
                chart.data.datasets[0].data = matieres.map(m => m.note);
                chart.update();
            }
        }

        function supprimer(index) {
            matieres.splice(index, 1);
            save();
        }

        // --- Events ---
        document.getElementById('btn-add').onclick = () => {
            const nom = document.getElementById('nom-matiere').value.trim();
            const note = parseFloat(document.getElementById('moy-matiere').value);
            const coeff = parseFloat(document.getElementById('coeff-matiere').value) || 1;

            if (!nom || isNaN(note)) return;

            matieres.push({ nom, note, coeff });
            save();

            document.getElementById('nom-matiere').value = '';
            document.getElementById('moy-matiere').value = '';
            document.getElementById('coeff-matiere').value = '1';
        };

        document.getElementById('btn-ia').onclick = async () => {
            if (matieres.length === 0) return;
            const respDiv = document.getElementById('ai-response');
            respDiv.textContent = "Analyse de tes r√©sultats en cours...";

            const prompt = `Voici mes notes : ${matieres.map(m => m.nom + ": " + m.note + "/20").join(', ')}. Donne-moi un conseil tr√®s court et motivant pour chaque mati√®re. R√©ponds en fran√ßais.`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${geminiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                const data = await response.json();
                respDiv.innerHTML = `<div class="whitespace-pre-wrap">${data.candidates[0].content.parts[0].text}</div>`;
            } catch (e) {
                respDiv.textContent = "L'IA est indisponible pour le moment, mais tes notes sont bien enregistr√©es !";
            }
        };

        window.onload = initChart;
    </script>
</body>
</html>
 
